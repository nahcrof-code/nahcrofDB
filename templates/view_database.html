<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | nahcrofDB</title>
    <link rel="stylesheet" href="/ui/hostui.css">
    <style>	
	body {
	    display: grid;
	    justify-content: center;
	}

	header {
	    margin-top: 25px;
	}

	header h1 {
	    margin-left: 200px;
	    margin-top: -27px;
	}
	a {
	    text-decoration: none;
	    color: var(--text);
	}
	.container {
	    width: 70vw;
	}
	.pretty {
	    color: #4B78FF;
	}

	.btn {
	    width: auto;
	}

	.btn-white {
	    width: auto;
	}


	.top-buttons {
	    display: flex;
	}

	.cards {
	    margin-top: 25px;
	    display: flex;
	    justify-content: center;
	    flex-wrap: wrap;
	}

	.card {
	    margin-right: 20px;
	    font-size: 1.3rem;
	    padding-left: 20px;
	    padding-right: 20px;
	    padding-top: 15px;
	    padding-bottom: 15px;
	    border: 1px solid;
	    border-color: var(--border);
	    border-radius: 20px;
	    background: var(--dark-background);
	    width: 18%;
	    min-width: 100px;
	    transition: 0.3s ease;
	}

	.card:hover {
	    background: var(--background);
	}

	p {
	    margin-top: 0px;
	    margin-bottom: 10px;
	}

	h2 {
	    margin-top: 0px;
	    margin-bottom: 0px;
	}

	.danger {
	    margin-left: 5%;
	    margin-top: 15vh;
	    display: flex;
	    flex-wrap: wrap;
	}

	.btn-red {
	    margin-right: 20px;
	    width: auto;
	    font-size: 1.3rem;
	}

	.btn-blue {
	    margin-right: 20px;
	    width: auto;
	    font-size: 1.3rem;
	}

	.logs {
	    margin-top: 15vh;
	    margin-left: 5%; 
	}
	.log-header{
	    margin-bottom: 5px;
	}

	.log {
	    padding: 2px;
	    border-bottom: 1px solid var(--border);
	}


    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
	<a href="/dashboard" class="btn back">
	    <i class="fas fa-arrow-left"></i> Back to Dashboard
	</a>
	<h1 class="pretty">{{database}}</h1>
	<div style="border-bottom: 1px solid var(--text); width: 100%; margin-top: 15px;"></div>
    </header>
    <div class="container"><br>
	<div class="cards">

	    <div class="card">
		<p>Total Keys</p>
		<h2 class="pretty">{{keys}}</h2>
	    </div>

	    <div class="card">
		<p>Database size</p>
		<h2 class="pretty">{{dbsize}}MB</h2>
	    </div>

	    <div class="card">
		<p>Partitions</p>
		<h2 class="pretty">{{partitions}}</h2>
	    </div>

	    <div class="card">
		<p>Writes in Queue</p>
		<h2 class="pretty">{{writing}}</h2>
	    </div>

	</div>

	<div class="danger">
	    <button class="btn-blue" onclick="location.href = '/backup/{{database}}';">Backup Database</button>
	    <button class="btn-red width-auto" onclick="delete_warning();">Delete Database</button>
	    <button class="btn-red width-auto" onclick="set_to_backup_warning();">Restore from backup</button>
	</div>

	<div class="logs">
	    <h2 class="log-header">Error Logs (most recent at bottom):</h2>
	    {% for log in logs %}
		<div class="log">{{log}}</div> 
	    {% endfor %}
	</div>
    </div>
    <script>
	function delete_warning() {
            let choose_delete = confirm("WARNING: This will PERMANENTLY delete the \"{{database}}\" database and all its data.");
            if (choose_delete) {
                location.href = '/delete/{{database}}';
            }
        }

	function set_to_backup_warning() {
            let choose_restore = confirm("WARNING: This will replace the \"{{database}}\" database with its most recent backup. Current data will be lost.");
            if (choose_restore) {
                location.href = '/to_backup/{{database}}';
            }
        }
    </script>
</body>
</html>
